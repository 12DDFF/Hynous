{"version":3,"sources":["../../src/constants.ts","../../src/edges/weight/index.ts","../../src/edges/index.ts"],"names":["nanoid","z"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @module @nous/core/constants\n * @description All constants, enums, and configuration values\n * @version 0.1.0\n * @spec Brainstorms/Specs/storm-011/spec/constants.ts\n */\n\n// ============================================================\n// ID CONFIGURATION\n// ============================================================\n\n/** Length of nanoid for globally unique IDs */\nexport const NANOID_LENGTH = 12;\n\n/** Prefix for node IDs: \"n_\" + nanoid(12) */\nexport const NODE_ID_PREFIX = 'n_';\n\n/** Prefix for block IDs: \"b_\" + nanoid(12) */\nexport const BLOCK_ID_PREFIX = 'b_';\n\n/** Prefix for edge IDs: \"e_\" + nanoid(12) */\nexport const EDGE_ID_PREFIX = 'e_';\n\n/** Prefix for edit record IDs: \"edit_\" + nanoid(12) */\nexport const EDIT_ID_PREFIX = 'edit_';\n\n// ============================================================\n// NODE TYPES\n// ============================================================\n\nexport const NODE_TYPES = [\n  'concept',\n  'episode',\n  'document',\n  'section',\n  'chunk',\n  'note',\n  'raw',\n] as const;\n\nexport type NodeType = (typeof NODE_TYPES)[number];\n\nexport const SEMANTIC_LAYER_TYPES: NodeType[] = ['concept', 'note', 'chunk'];\nexport const EPISODE_LAYER_TYPES: NodeType[] = ['episode', 'document', 'section'];\nexport const ARCHIVE_LAYER_TYPES: NodeType[] = ['raw'];\n\n// ============================================================\n// SUBTYPES\n// ============================================================\n\nexport const CONCEPT_SUBTYPES = [\n  'fact',\n  'definition',\n  'relationship',\n  'preference',\n  'belief',\n  'procedure',\n  'entity',\n  'event',\n  'insight',\n] as const;\n\nexport type ConceptSubtype = (typeof CONCEPT_SUBTYPES)[number] | `custom:${string}`;\n\nexport const EPISODE_SUBTYPES = [\n  'lecture',\n  'meeting',\n  'conversation',\n  'note_session',\n  'document_read',\n  'thought',\n  'external_event',\n] as const;\n\nexport type EpisodeSubtype = (typeof EPISODE_SUBTYPES)[number] | `custom:${string}`;\n\nexport const RAW_SUBTYPES = [\n  'transcript',\n  'document',\n  'note',\n  'image',\n  'audio_recording',\n] as const;\n\nexport type RawSubtype = (typeof RAW_SUBTYPES)[number];\n\n// ============================================================\n// BLOCK TYPES\n// ============================================================\n\nexport const BLOCK_TYPES = [\n  'paragraph',\n  'heading',\n  'list',\n  'list_item',\n  'code',\n  'quote',\n  'callout',\n  'divider',\n  'table',\n  'image',\n] as const;\n\nexport type BlockType = (typeof BLOCK_TYPES)[number];\n\n// ============================================================\n// EDGE TYPES\n// ============================================================\n\nexport const EDGE_TYPES = [\n  'relates_to',\n  'part_of',\n  'mentioned_in',\n  'causes',\n  'precedes',\n  'contradicts',\n  'supersedes',\n  'derived_from',\n  'similar_to',\n] as const;\n\nexport type EdgeType = (typeof EDGE_TYPES)[number];\n\n// ============================================================\n// LIFECYCLE STATES\n// ============================================================\n\nexport const LIFECYCLE_STATES = [\n  'working',\n  'active',\n  'superseded',\n  'dormant',\n  'archived',\n] as const;\n\nexport type LifecycleState = (typeof LIFECYCLE_STATES)[number];\n\n// ============================================================\n// SOURCE TYPES\n// ============================================================\n\nexport const SOURCE_TYPES = [\n  'extraction',\n  'manual',\n  'inference',\n  'import',\n] as const;\n\nexport type SourceType = (typeof SOURCE_TYPES)[number];\n\n// ============================================================\n// CONTENT SOURCES\n// ============================================================\n\nexport const CONTENT_SOURCES = [\n  'import',\n  'user_note',\n  'chat_extraction',\n  'fact',\n  'document',\n  'transcript',\n] as const;\n\nexport type ContentSource = (typeof CONTENT_SOURCES)[number];\n\n// ============================================================\n// EDIT SYSTEM\n// ============================================================\n\nexport const EDIT_TARGET_METHODS = [\n  'block_id',\n  'heading',\n  'position',\n  'search',\n  'full',\n] as const;\n\nexport type EditTargetMethod = (typeof EDIT_TARGET_METHODS)[number];\n\nexport const EDIT_ACTIONS = ['replace', 'insert', 'append', 'delete'] as const;\n\nexport type EditAction = (typeof EDIT_ACTIONS)[number];\n\nexport const MODIFIERS = ['user', 'ai', 'system', 'sync'] as const;\n\nexport type Modifier = (typeof MODIFIERS)[number];\n\nexport const EDIT_HISTORY_RETENTION = {\n  maxEdits: 100,\n  maxAgeDays: 30,\n  undoWindowHours: 24,\n  pruneSchedule: 'daily',\n} as const;\n\n// ============================================================\n// TEMPORAL\n// ============================================================\n\nexport const TEMPORAL_GRANULARITIES = [\n  'minute',\n  'hour',\n  'day',\n  'week',\n  'month',\n  'year',\n] as const;\n\nexport type TemporalGranularity = (typeof TEMPORAL_GRANULARITIES)[number];\n\nexport const EVENT_TIME_SOURCES = ['explicit', 'inferred', 'user_stated'] as const;\n\nexport type EventTimeSource = (typeof EVENT_TIME_SOURCES)[number];\n\nexport const CONTENT_TIME_TYPES = ['historical', 'relative', 'approximate'] as const;\n\nexport type ContentTimeType = (typeof CONTENT_TIME_TYPES)[number];\n\n// ============================================================\n// PROCESSING PATHS\n// ============================================================\n\nexport const INPUT_TYPES = [\n  'DOCUMENT',\n  'TRANSCRIPT',\n  'CONVERSATION',\n  'NOTE',\n  'IMPORT',\n] as const;\n\nexport type InputType = (typeof INPUT_TYPES)[number];\n\nexport const INPUT_SIZES = ['tiny', 'small', 'medium', 'large', 'huge'] as const;\n\nexport type InputSize = (typeof INPUT_SIZES)[number];\n\nexport const PROCESSING_PATHS = [\n  'fast',\n  'standard',\n  'progressive',\n  'conversation',\n] as const;\n\nexport type ProcessingPath = (typeof PROCESSING_PATHS)[number];\n\nexport const SIZE_THRESHOLDS = {\n  tiny: { min: 0, max: 50 },\n  small: { min: 50, max: 500 },\n  medium: { min: 500, max: 5000 },\n  large: { min: 5000, max: 25000 },\n  huge: { min: 25000, max: Infinity },\n} as const;\n\n// ============================================================\n// BLOCK DECISION THRESHOLDS\n// ============================================================\n\nexport const BLOCK_LENGTH_THRESHOLD = 1000;\nexport const BLOCK_LIST_THRESHOLD = 3;\n\n// ============================================================\n// NEURAL DEFAULTS\n// ============================================================\n\nexport const NEURAL_DEFAULTS = {\n  stability: 0.5,\n  retrievability: 1.0,\n  accessCount: 0,\n} as const;\n\n// ============================================================\n// EXTRACTION DEPTH\n// ============================================================\n\nexport const EXTRACTION_DEPTHS = ['summary', 'section', 'full'] as const;\n\nexport type ExtractionDepth = (typeof EXTRACTION_DEPTHS)[number];\n\n// ============================================================\n// REGEX PATTERNS\n// ============================================================\n\nexport const HEADING_PATTERN = /^#{1,6}\\s/m;\nexport const LIST_ITEM_PATTERN = /^[-*]\\s/gm;\n","/**\n * @module @nous/core/edges/weight\n * @description Edge Weight Determination System (EWDS) - 5-source weight calculation with Hebbian evolution\n * @version 1.0.0\n * @spec Brainstorms/Specs/Phase-2-Data-Representation/storm-031\n *\n * This module implements storm-031: Edge Weight Calculation & Clustering.\n *\n * Key concepts:\n * - 5 edge creation sources: extraction, similarity, user, temporal, coactivation\n * - Three-part weight: base × (1 + learned) + coactivation_bonus\n * - Hebbian learning with consecutive ignore tracking\n * - Adaptive compression for graph management\n */\n\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport {\n  NANOID_LENGTH,\n  EDGE_ID_PREFIX,\n  type SourceType,\n} from '../../constants';\nimport type { NousEdge } from '../index';\n\n// ============================================================\n// EXTENDED EDGE TYPES (storm-031 additions)\n// ============================================================\n\n/**\n * Extended edge types including storm-031 additions.\n */\nexport const EXTENDED_EDGE_TYPES = [\n  // From storm-011\n  'relates_to',\n  'part_of',\n  'mentioned_in',\n  'causes',\n  'precedes',\n  'contradicts',\n  'supersedes',\n  'derived_from',\n  'similar_to',\n  // New in storm-031\n  'same_entity',\n  'user_linked',\n  'caused_by',\n  'mentioned_together',\n  'temporal_adjacent',\n  'temporal_continuation',\n  'summarizes',\n] as const;\n\nexport type ExtendedEdgeType = (typeof EXTENDED_EDGE_TYPES)[number];\n\n// ============================================================\n// EDGE TYPE WEIGHTS\n// ============================================================\n\n/**\n * Default base weights for each edge type.\n * Higher values = stronger relationships.\n */\nexport const EDGE_WEIGHTS: Record<ExtendedEdgeType, number> = {\n  // Identity / structural (highest)\n  same_entity: 0.95,\n  summarizes: 0.95,\n  // User-created (high trust)\n  user_linked: 0.90,\n  // Semantic relationships\n  part_of: 0.85,\n  caused_by: 0.80,\n  causes: 0.80,\n  contradicts: 0.75,\n  supersedes: 0.75,\n  derived_from: 0.70,\n  precedes: 0.65,\n  mentioned_together: 0.60,\n  mentioned_in: 0.55,\n  relates_to: 0.50,\n  similar_to: 0.45,\n  // Temporal (lowest)\n  temporal_adjacent: 0.40,\n  temporal_continuation: 0.30,\n};\n\n// ============================================================\n// EDGE STATUS & CREATION SOURCE\n// ============================================================\n\nexport const EDGE_STATUSES = ['confirmed', 'provisional'] as const;\nexport type EdgeStatus = (typeof EDGE_STATUSES)[number];\n\nexport const EDGE_CREATION_SOURCES = [\n  'extraction',\n  'similarity',\n  'user',\n  'temporal',\n  'coactivation',\n  'compression',\n] as const;\nexport type EdgeCreationSource = (typeof EDGE_CREATION_SOURCES)[number];\n\n// ============================================================\n// CONFIGURATION CONSTANTS\n// ============================================================\n\n/**\n * Extraction-time edge creation configuration.\n */\nexport const EXTRACTION_CONFIG = {\n  confirmed_threshold: 0.70,\n  provisional_threshold: 0.50,\n  rejection_threshold: 0.50,\n  provisional_weight_factor: 0.5,\n  provisional_promotion_activations: 3,\n  provisional_expiry_days: 30,\n} as const;\n\n/**\n * Similarity-based edge creation configuration.\n */\nexport const SIMILARITY_CONFIG = {\n  creation_threshold: 0.85,\n  edge_type: 'similar_to' as ExtendedEdgeType,\n  batch_frequency: 'daily' as const,\n  max_edges_per_node: 10,\n  exclude_same_cluster: false,\n} as const;\n\n/**\n * User-created edge configuration.\n */\nexport const USER_EDGE_CONFIG = {\n  default_strength: 0.90,\n  min_strength: 0.50,\n  max_strength: 1.00,\n  default_type: 'user_linked' as ExtendedEdgeType,\n  allowed_types: [\n    'user_linked',\n    'relates_to',\n    'part_of',\n    'caused_by',\n    'contradicts',\n    'supersedes',\n    'derived_from',\n  ] as ExtendedEdgeType[],\n} as const;\n\n/**\n * Temporal edge configuration.\n */\nexport const TEMPORAL_CONFIG = {\n  session_timeout_minutes: 30,\n  edge_type: 'temporal_adjacent' as ExtendedEdgeType,\n  decay_constant: 30,\n  max_gap_minutes: 120,\n  min_strength: 0.20,\n  continuation_max_gap_hours: 24,\n  continuation_base_weight: 0.30,\n  continuation_same_cluster_required: true,\n  continuation_edge_type: 'temporal_continuation' as ExtendedEdgeType,\n} as const;\n\n/**\n * Hebbian learning and co-activation configuration.\n */\nexport const COACTIVATION_CONFIG = {\n  strengthen_delta: 0.10,\n  decay_delta: 0.02,\n  min_weight: 0.10,\n  max_weight: 1.00,\n  engagement_threshold_seconds: 5,\n  consecutive_ignores_before_decay: 3,\n  max_coactivation_bonus: 0.30,\n  new_edge_similarity_threshold: 0.50,\n} as const;\n\n/**\n * Time-based edge decay configuration.\n */\nexport const EDGE_DECAY_CONFIG = {\n  decay_start_days: 30,\n  decay_rate: 0.95,\n  decay_period_days: 30,\n  floor: 0.10,\n} as const;\n\n/**\n * Compression default configuration.\n */\nexport const COMPRESSION_DEFAULTS = {\n  min_nodes_for_compression: 5,\n  similarity_threshold: 0.75,\n  max_nodes_per_summary: 20,\n  restorable_days: 365,\n  dormant_days_minimum: 60,\n  importance_max: 0.3,\n  strong_active_edges_max: 2,\n  age_days_minimum: 30,\n} as const;\n\n/**\n * Graph size thresholds for adaptive compression.\n */\nexport const GRAPH_SIZE_THRESHOLDS = {\n  small: { max: 500, min_nodes: 3 },\n  medium: { max: 5000, min_nodes: 5 },\n  large: { max: Infinity, min_nodes: 10 },\n} as const;\n\n/**\n * Weight bounds for all edges.\n */\nexport const WEIGHT_BOUNDS = {\n  min: 0.10,\n  max: 1.00,\n} as const;\n\n/**\n * Learned adjustment bounds.\n */\nexport const LEARNED_ADJUSTMENT_BOUNDS = {\n  min: -0.30,\n  max: 0.30,\n} as const;\n\n// ============================================================\n// CORE TYPES\n// ============================================================\n\n/**\n * Weight component decomposition.\n */\nexport interface EdgeWeightComponents {\n  base_weight: number;\n  learned_adjustment: number;\n  coactivation_bonus: number;\n}\n\n/**\n * Extended edge with weight components.\n */\nexport interface WeightedEdge extends Omit<NousEdge, 'type'> {\n  type: ExtendedEdgeType;\n  status: EdgeStatus;\n  components: EdgeWeightComponents;\n  creation_source: EdgeCreationSource;\n  consecutive_ignored: number;\n  activation_count: number;\n}\n\n/**\n * Result of calculating effective weight.\n */\nexport interface EffectiveWeightResult {\n  effective_weight: number;\n  was_clamped: boolean;\n  raw_value: number;\n}\n\n/**\n * Provisional edge state tracking.\n */\nexport interface ProvisionalEdgeState {\n  created_at: string;\n  activation_count: number;\n  expires_at: string;\n}\n\n/**\n * Extraction edge result.\n */\nexport interface ExtractionEdgeResult {\n  weight: number;\n  status: EdgeStatus;\n  components: EdgeWeightComponents;\n}\n\n/**\n * Temporal edge result.\n */\nexport interface TemporalEdgeResult {\n  source: string;\n  target: string;\n  type: 'temporal_adjacent' | 'temporal_continuation';\n  weight: number;\n  components: EdgeWeightComponents;\n}\n\n/**\n * Session for temporal edge detection.\n */\nexport interface Session {\n  id: string;\n  start: string;\n  end: string;\n  accessedNodes: SessionNode[];\n}\n\n/**\n * Node accessed during a session.\n */\nexport interface SessionNode {\n  id: string;\n  cluster_id: string;\n  accessed_at: string;\n}\n\n/**\n * Co-activation update result.\n */\nexport interface CoactivationUpdateResult {\n  edge: WeightedEdge;\n  action: 'strengthened' | 'decayed' | 'unchanged';\n  previous_weight: number;\n  new_weight: number;\n  reason: string;\n}\n\n/**\n * Time-based decay result.\n */\nexport interface DecayResult {\n  decay_periods: number;\n  decay_factor: number;\n  previous_bonus: number;\n  new_bonus: number;\n  decay_applied: boolean;\n}\n\n/**\n * Compression configuration.\n */\nexport interface CompressionConfig {\n  never_compress: {\n    is_pinned: boolean;\n    is_starred: boolean;\n    age_days_less_than: number;\n  };\n  candidate_requirements: {\n    dormant_days_minimum: number;\n    importance_max: number;\n    strong_active_edges_max: number;\n  };\n  clustering: {\n    similarity_threshold: number;\n    min_nodes_for_compression: number;\n    max_nodes_per_summary: number;\n  };\n  retention: {\n    restorable_days: number;\n  };\n}\n\n/**\n * Summary node content.\n */\nexport interface SummaryContent {\n  title: string;\n  body: string;\n  preserved_entities: string[];\n  key_facts: string[];\n  temporal_span: string | null;\n}\n\n/**\n * Compressed edge record for restoration.\n */\nexport interface CompressedEdgeRecord {\n  original_source: string;\n  target: string;\n  original_type: string;\n  original_weight: number;\n}\n\n/**\n * Summary node from compression.\n */\nexport interface SummaryNode {\n  id: string;\n  type: 'summary';\n  content: SummaryContent;\n  compressed_from: string[];\n  compressed_edges: CompressedEdgeRecord[];\n  cluster_id: string;\n  created_at: string;\n}\n\n/**\n * Node compression state.\n */\nexport interface NodeCompressionState {\n  compressed_into?: string;\n  compressed_at?: string;\n  restorable_until?: string;\n}\n\n/**\n * Embedding freshness state.\n */\nexport interface EmbeddingFreshnessState {\n  embedding_version: number;\n  last_content_update: string;\n  last_embedding_update: string;\n}\n\n// ============================================================\n// ZOD SCHEMAS\n// ============================================================\n\nexport const EdgeWeightComponentsSchema = z.object({\n  base_weight: z.number().min(0).max(1),\n  learned_adjustment: z.number().min(LEARNED_ADJUSTMENT_BOUNDS.min).max(LEARNED_ADJUSTMENT_BOUNDS.max),\n  coactivation_bonus: z.number().min(0).max(COACTIVATION_CONFIG.max_coactivation_bonus),\n});\n\nexport const EdgeStatusSchema = z.enum(EDGE_STATUSES);\nexport const EdgeCreationSourceSchema = z.enum(EDGE_CREATION_SOURCES);\n\nexport const ProvisionalEdgeStateSchema = z.object({\n  created_at: z.string().datetime(),\n  activation_count: z.number().int().min(0),\n  expires_at: z.string().datetime(),\n});\n\nexport const ExtractionEdgeResultSchema = z.object({\n  weight: z.number().min(0).max(1),\n  status: EdgeStatusSchema,\n  components: EdgeWeightComponentsSchema,\n});\n\nexport const SessionNodeSchema = z.object({\n  id: z.string(),\n  cluster_id: z.string(),\n  accessed_at: z.string().datetime(),\n});\n\nexport const SessionSchema = z.object({\n  id: z.string(),\n  start: z.string().datetime(),\n  end: z.string().datetime(),\n  accessedNodes: z.array(SessionNodeSchema),\n});\n\nexport const TemporalEdgeResultSchema = z.object({\n  source: z.string(),\n  target: z.string(),\n  type: z.enum(['temporal_adjacent', 'temporal_continuation']),\n  weight: z.number().min(0).max(1),\n  components: EdgeWeightComponentsSchema,\n});\n\nexport const DecayResultSchema = z.object({\n  decay_periods: z.number().int().min(0),\n  decay_factor: z.number().min(0).max(1),\n  previous_bonus: z.number().min(0),\n  new_bonus: z.number().min(0),\n  decay_applied: z.boolean(),\n});\n\nexport const SummaryContentSchema = z.object({\n  title: z.string().max(60),\n  body: z.string(),\n  preserved_entities: z.array(z.string()),\n  key_facts: z.array(z.string()),\n  temporal_span: z.string().nullable(),\n});\n\nexport const CompressedEdgeRecordSchema = z.object({\n  original_source: z.string(),\n  target: z.string(),\n  original_type: z.string(),\n  original_weight: z.number().min(0).max(1),\n});\n\nexport const SummaryNodeSchema = z.object({\n  id: z.string(),\n  type: z.literal('summary'),\n  content: SummaryContentSchema,\n  compressed_from: z.array(z.string()),\n  compressed_edges: z.array(CompressedEdgeRecordSchema),\n  cluster_id: z.string(),\n  created_at: z.string().datetime(),\n});\n\nexport const NodeCompressionStateSchema = z.object({\n  compressed_into: z.string().optional(),\n  compressed_at: z.string().datetime().optional(),\n  restorable_until: z.string().datetime().optional(),\n});\n\nexport const EmbeddingFreshnessStateSchema = z.object({\n  embedding_version: z.number().int().min(0),\n  last_content_update: z.string().datetime(),\n  last_embedding_update: z.string().datetime(),\n});\n\n// ============================================================\n// HELPER FUNCTIONS\n// ============================================================\n\n/**\n * Calculates days between two dates.\n */\nfunction daysBetween(start: string | Date, end: string | Date): number {\n  const startDate = typeof start === 'string' ? new Date(start) : start;\n  const endDate = typeof end === 'string' ? new Date(end) : end;\n  return Math.floor((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Calculates minutes between two timestamps.\n */\nfunction minutesBetween(start: string, end: string): number {\n  const startDate = new Date(start);\n  const endDate = new Date(end);\n  return Math.abs(endDate.getTime() - startDate.getTime()) / (1000 * 60);\n}\n\n/**\n * Calculates hours between two timestamps.\n */\nfunction hoursBetween(start: string, end: string): number {\n  return minutesBetween(start, end) / 60;\n}\n\n// ============================================================\n// CORE WEIGHT FUNCTIONS\n// ============================================================\n\n/**\n * Calculates effective weight from components.\n * Formula: effective = base × (1 + learned) + coactivation\n */\nexport function calculateEffectiveWeight(components: EdgeWeightComponents): EffectiveWeightResult {\n  const adjustedBase = components.base_weight * (1 + components.learned_adjustment);\n  const rawValue = adjustedBase + components.coactivation_bonus;\n\n  const clamped = Math.max(WEIGHT_BOUNDS.min, Math.min(WEIGHT_BOUNDS.max, rawValue));\n\n  return {\n    effective_weight: clamped,\n    was_clamped: clamped !== rawValue,\n    raw_value: rawValue,\n  };\n}\n\n/**\n * Creates weight components with defaults.\n */\nexport function createWeightComponents(input: {\n  base_weight: number;\n  learned_adjustment?: number;\n  coactivation_bonus?: number;\n}): EdgeWeightComponents {\n  return {\n    base_weight: input.base_weight,\n    learned_adjustment: input.learned_adjustment ?? 0,\n    coactivation_bonus: input.coactivation_bonus ?? 0,\n  };\n}\n\n/**\n * Applies a learning adjustment to components.\n */\nexport function applyLearningAdjustment(\n  components: EdgeWeightComponents,\n  delta: number\n): EdgeWeightComponents {\n  const newAdjustment = components.learned_adjustment + delta;\n  const clamped = Math.max(\n    LEARNED_ADJUSTMENT_BOUNDS.min,\n    Math.min(LEARNED_ADJUSTMENT_BOUNDS.max, newAdjustment)\n  );\n\n  return {\n    ...components,\n    learned_adjustment: clamped,\n  };\n}\n\n/**\n * Applies a coactivation bonus to components.\n */\nexport function applyCoactivationBonus(\n  components: EdgeWeightComponents,\n  delta: number\n): EdgeWeightComponents {\n  const newBonus = components.coactivation_bonus + delta;\n  const clamped = Math.max(0, Math.min(COACTIVATION_CONFIG.max_coactivation_bonus, newBonus));\n\n  return {\n    ...components,\n    coactivation_bonus: clamped,\n  };\n}\n\n/**\n * Decays coactivation bonus by a factor.\n */\nexport function decayCoactivationBonus(\n  components: EdgeWeightComponents,\n  factor: number\n): EdgeWeightComponents {\n  return {\n    ...components,\n    coactivation_bonus: Math.max(0, components.coactivation_bonus * factor),\n  };\n}\n\n// ============================================================\n// EXTRACTION EDGE FUNCTIONS\n// ============================================================\n\n/**\n * Calculates extraction edge result based on LLM confidence.\n */\nexport function calculateExtractionEdge(\n  type: ExtendedEdgeType,\n  llmConfidence: number\n): ExtractionEdgeResult | null {\n  const baseWeight = EDGE_WEIGHTS[type] ?? 0.5;\n\n  if (llmConfidence >= EXTRACTION_CONFIG.confirmed_threshold) {\n    const weight = baseWeight * llmConfidence;\n    return {\n      weight,\n      status: 'confirmed',\n      components: createWeightComponents({ base_weight: weight }),\n    };\n  }\n\n  if (llmConfidence >= EXTRACTION_CONFIG.provisional_threshold) {\n    const weight = baseWeight * llmConfidence * EXTRACTION_CONFIG.provisional_weight_factor;\n    return {\n      weight,\n      status: 'provisional',\n      components: createWeightComponents({ base_weight: weight }),\n    };\n  }\n\n  return null;\n}\n\n/**\n * Creates provisional edge state.\n */\nexport function createProvisionalState(): ProvisionalEdgeState {\n  const now = new Date();\n  const expiresAt = new Date(now);\n  expiresAt.setDate(expiresAt.getDate() + EXTRACTION_CONFIG.provisional_expiry_days);\n\n  return {\n    created_at: now.toISOString(),\n    activation_count: 0,\n    expires_at: expiresAt.toISOString(),\n  };\n}\n\n/**\n * Checks if provisional edge should be promoted.\n */\nexport function shouldPromoteProvisional(state: ProvisionalEdgeState): boolean {\n  return state.activation_count >= EXTRACTION_CONFIG.provisional_promotion_activations;\n}\n\n/**\n * Checks if provisional edge has expired.\n */\nexport function shouldExpireProvisional(state: ProvisionalEdgeState): boolean {\n  const now = new Date();\n  const expiresAt = new Date(state.expires_at);\n\n  return now > expiresAt && state.activation_count < EXTRACTION_CONFIG.provisional_promotion_activations;\n}\n\n/**\n * Increments provisional edge activation count.\n */\nexport function incrementProvisionalActivation(state: ProvisionalEdgeState): ProvisionalEdgeState {\n  return {\n    ...state,\n    activation_count: state.activation_count + 1,\n  };\n}\n\n// ============================================================\n// SIMILARITY EDGE FUNCTIONS\n// ============================================================\n\n/**\n * Checks if similarity meets threshold for edge creation.\n */\nexport function meetsSimilarityThreshold(similarity: number): boolean {\n  return similarity >= SIMILARITY_CONFIG.creation_threshold;\n}\n\n/**\n * Checks if embedding is fresh.\n */\nexport function isEmbeddingFresh(state: EmbeddingFreshnessState): boolean {\n  const contentDate = new Date(state.last_content_update);\n  const embeddingDate = new Date(state.last_embedding_update);\n  return embeddingDate >= contentDate;\n}\n\n/**\n * Calculates similarity edge weight.\n */\nexport function calculateSimilarityWeight(cosineSimilarity: number): number {\n  return cosineSimilarity;\n}\n\n// ============================================================\n// USER EDGE FUNCTIONS\n// ============================================================\n\n/**\n * Calculates user edge weight with bounds.\n */\nexport function calculateUserEdgeWeight(userStrength?: number): number {\n  if (userStrength === undefined) {\n    return USER_EDGE_CONFIG.default_strength;\n  }\n  return Math.max(\n    USER_EDGE_CONFIG.min_strength,\n    Math.min(USER_EDGE_CONFIG.max_strength, userStrength)\n  );\n}\n\n/**\n * Checks if edge type is allowed for user creation.\n */\nexport function isAllowedUserEdgeType(type: string): boolean {\n  return USER_EDGE_CONFIG.allowed_types.includes(type as ExtendedEdgeType);\n}\n\n// ============================================================\n// TEMPORAL EDGE FUNCTIONS\n// ============================================================\n\n/**\n * Calculates temporal weight based on time gap.\n * Uses exponential decay: e^(-t/30)\n */\nexport function calculateTemporalWeight(minutesApart: number): number | null {\n  if (minutesApart > TEMPORAL_CONFIG.max_gap_minutes) {\n    return null;\n  }\n\n  const rawWeight = Math.exp(-minutesApart / TEMPORAL_CONFIG.decay_constant);\n  return Math.max(TEMPORAL_CONFIG.min_strength, rawWeight);\n}\n\n/**\n * Creates a temporal adjacent edge.\n */\nexport function createTemporalAdjacentEdge(\n  nodeA: string,\n  nodeB: string,\n  minutesApart: number\n): TemporalEdgeResult | null {\n  const weight = calculateTemporalWeight(minutesApart);\n\n  if (weight === null) {\n    return null;\n  }\n\n  return {\n    source: nodeA,\n    target: nodeB,\n    type: 'temporal_adjacent',\n    weight,\n    components: createWeightComponents({ base_weight: weight }),\n  };\n}\n\n/**\n * Checks continuation edge eligibility between sessions.\n */\nexport function checkContinuationEligibility(\n  currentSession: Session,\n  previousSession: Session\n): { should_create: boolean; overlapping_clusters: string[]; hours_between: number } {\n  const gap = hoursBetween(previousSession.end, currentSession.start);\n\n  if (gap > TEMPORAL_CONFIG.continuation_max_gap_hours) {\n    return { should_create: false, overlapping_clusters: [], hours_between: gap };\n  }\n\n  const currentClusters = new Set(currentSession.accessedNodes.map((n) => n.cluster_id));\n  const previousClusters = new Set(previousSession.accessedNodes.map((n) => n.cluster_id));\n  const overlapping = [...currentClusters].filter((c) => previousClusters.has(c));\n\n  return {\n    should_create: overlapping.length > 0,\n    overlapping_clusters: overlapping,\n    hours_between: gap,\n  };\n}\n\n/**\n * Detects continuation edges between sessions.\n */\nexport function detectContinuationEdges(\n  currentSession: Session,\n  previousSession: Session\n): TemporalEdgeResult[] {\n  const eligibility = checkContinuationEligibility(currentSession, previousSession);\n\n  if (!eligibility.should_create) {\n    return [];\n  }\n\n  const edges: TemporalEdgeResult[] = [];\n\n  for (const clusterId of eligibility.overlapping_clusters) {\n    const currentNodes = currentSession.accessedNodes.filter((n) => n.cluster_id === clusterId);\n    const previousNodes = previousSession.accessedNodes.filter((n) => n.cluster_id === clusterId);\n\n    for (const prev of previousNodes) {\n      for (const curr of currentNodes) {\n        if (prev.id !== curr.id) {\n          edges.push({\n            source: prev.id,\n            target: curr.id,\n            type: 'temporal_continuation',\n            weight: TEMPORAL_CONFIG.continuation_base_weight,\n            components: createWeightComponents({\n              base_weight: TEMPORAL_CONFIG.continuation_base_weight,\n            }),\n          });\n        }\n      }\n    }\n  }\n\n  return edges;\n}\n\n/**\n * Creates temporal edges for nodes in a session.\n */\nexport function createSessionTemporalEdges(session: Session): TemporalEdgeResult[] {\n  const edges: TemporalEdgeResult[] = [];\n\n  const sortedNodes = [...session.accessedNodes].sort(\n    (a, b) => new Date(a.accessed_at).getTime() - new Date(b.accessed_at).getTime()\n  );\n\n  for (let i = 0; i < sortedNodes.length - 1; i++) {\n    const current = sortedNodes[i]!;\n    const next = sortedNodes[i + 1]!;\n    const gap = minutesBetween(current.accessed_at, next.accessed_at);\n\n    const edge = createTemporalAdjacentEdge(current.id, next.id, gap);\n    if (edge) {\n      edges.push(edge);\n    }\n  }\n\n  return edges;\n}\n\n/**\n * Checks if a session has ended.\n */\nexport function hasSessionEnded(lastAccessTime: string, currentTime: string): boolean {\n  const gap = minutesBetween(lastAccessTime, currentTime);\n  return gap >= TEMPORAL_CONFIG.session_timeout_minutes;\n}\n\n// ============================================================\n// CO-ACTIVATION FUNCTIONS\n// ============================================================\n\n/**\n * Determines if user engaged based on view duration.\n */\nexport function didUserEngage(viewDurationSeconds: number): boolean {\n  return viewDurationSeconds >= COACTIVATION_CONFIG.engagement_threshold_seconds;\n}\n\n/**\n * Calculates strengthening delta using asymptotic formula.\n */\nexport function calculateStrengtheningDelta(currentWeight: number): number {\n  return COACTIVATION_CONFIG.strengthen_delta * (COACTIVATION_CONFIG.max_weight - currentWeight);\n}\n\n/**\n * Updates co-activation weight based on user engagement.\n */\nexport function updateCoActivationWeight(\n  edge: WeightedEdge,\n  userEngaged: boolean\n): CoactivationUpdateResult {\n  const { effective_weight: previousWeight } = calculateEffectiveWeight(edge.components);\n  let newEdge = { ...edge };\n  let action: 'strengthened' | 'decayed' | 'unchanged' = 'unchanged';\n  let reason = '';\n\n  if (userEngaged) {\n    newEdge.consecutive_ignored = 0;\n    const delta = calculateStrengtheningDelta(previousWeight);\n    newEdge.components = applyCoactivationBonus(edge.components, delta);\n    action = 'strengthened';\n    reason = `User engaged - added ${delta.toFixed(3)} to bonus`;\n  } else {\n    newEdge.consecutive_ignored = edge.consecutive_ignored + 1;\n\n    if (newEdge.consecutive_ignored >= COACTIVATION_CONFIG.consecutive_ignores_before_decay) {\n      newEdge.consecutive_ignored = 0;\n      newEdge.components = applyCoactivationBonus(edge.components, -COACTIVATION_CONFIG.decay_delta);\n      action = 'decayed';\n      reason = `${COACTIVATION_CONFIG.consecutive_ignores_before_decay}+ consecutive ignores - subtracted ${COACTIVATION_CONFIG.decay_delta} from bonus`;\n    } else {\n      reason = `Ignored (${newEdge.consecutive_ignored}/${COACTIVATION_CONFIG.consecutive_ignores_before_decay} before decay)`;\n    }\n  }\n\n  newEdge.activation_count = edge.activation_count + 1;\n  newEdge.neural = {\n    ...edge.neural,\n    co_activation_count: edge.neural.co_activation_count + 1,\n    last_co_activation: new Date().toISOString(),\n  };\n\n  const { effective_weight: newWeight } = calculateEffectiveWeight(newEdge.components);\n\n  return {\n    edge: newEdge,\n    action,\n    previous_weight: previousWeight,\n    new_weight: newWeight,\n    reason,\n  };\n}\n\n/**\n * Applies time-based decay to an edge.\n */\nexport function applyTimeBasedDecay(edge: WeightedEdge): DecayResult {\n  const daysSinceActivation = daysBetween(edge.neural.last_co_activation, new Date());\n\n  if (daysSinceActivation < EDGE_DECAY_CONFIG.decay_start_days) {\n    return {\n      decay_periods: 0,\n      decay_factor: 1.0,\n      previous_bonus: edge.components.coactivation_bonus,\n      new_bonus: edge.components.coactivation_bonus,\n      decay_applied: false,\n    };\n  }\n\n  const decayPeriods = Math.floor(\n    (daysSinceActivation - EDGE_DECAY_CONFIG.decay_start_days) / EDGE_DECAY_CONFIG.decay_period_days\n  );\n\n  if (decayPeriods === 0) {\n    return {\n      decay_periods: 0,\n      decay_factor: 1.0,\n      previous_bonus: edge.components.coactivation_bonus,\n      new_bonus: edge.components.coactivation_bonus,\n      decay_applied: false,\n    };\n  }\n\n  const decayFactor = Math.pow(EDGE_DECAY_CONFIG.decay_rate, decayPeriods);\n  const previousBonus = edge.components.coactivation_bonus;\n  const newBonus = Math.max(0, previousBonus * decayFactor);\n\n  return {\n    decay_periods: decayPeriods,\n    decay_factor: decayFactor,\n    previous_bonus: previousBonus,\n    new_bonus: newBonus,\n    decay_applied: true,\n  };\n}\n\n/**\n * Checks if nodes are eligible for new co-activation edge.\n */\nexport function shouldConsiderNewEdge(similarity: number): boolean {\n  return similarity > COACTIVATION_CONFIG.new_edge_similarity_threshold;\n}\n\n/**\n * Checks if an edge is \"dead\" (at minimum weight).\n */\nexport function isEdgeDead(edge: WeightedEdge): boolean {\n  const { effective_weight } = calculateEffectiveWeight(edge.components);\n  return effective_weight <= COACTIVATION_CONFIG.min_weight && edge.components.coactivation_bonus <= 0;\n}\n\n// ============================================================\n// COMPRESSION FUNCTIONS\n// ============================================================\n\n/**\n * Gets compression configuration based on graph size.\n */\nexport function getCompressionConfig(graphSize: number): CompressionConfig {\n  let minNodes: number;\n\n  if (graphSize < GRAPH_SIZE_THRESHOLDS.small.max) {\n    minNodes = GRAPH_SIZE_THRESHOLDS.small.min_nodes;\n  } else if (graphSize < GRAPH_SIZE_THRESHOLDS.medium.max) {\n    minNodes = GRAPH_SIZE_THRESHOLDS.medium.min_nodes;\n  } else {\n    minNodes = GRAPH_SIZE_THRESHOLDS.large.min_nodes;\n  }\n\n  return {\n    never_compress: {\n      is_pinned: true,\n      is_starred: true,\n      age_days_less_than: COMPRESSION_DEFAULTS.age_days_minimum,\n    },\n    candidate_requirements: {\n      dormant_days_minimum: COMPRESSION_DEFAULTS.dormant_days_minimum,\n      importance_max: COMPRESSION_DEFAULTS.importance_max,\n      strong_active_edges_max: COMPRESSION_DEFAULTS.strong_active_edges_max,\n    },\n    clustering: {\n      similarity_threshold: COMPRESSION_DEFAULTS.similarity_threshold,\n      min_nodes_for_compression: minNodes,\n      max_nodes_per_summary: COMPRESSION_DEFAULTS.max_nodes_per_summary,\n    },\n    retention: {\n      restorable_days: COMPRESSION_DEFAULTS.restorable_days,\n    },\n  };\n}\n\n/**\n * Checks if a node should never be compressed.\n */\nexport function isNeverCompress(\n  node: { is_pinned: boolean; is_starred: boolean; created_at: string },\n  config: CompressionConfig\n): boolean {\n  if (node.is_pinned && config.never_compress.is_pinned) {\n    return true;\n  }\n  if (node.is_starred && config.never_compress.is_starred) {\n    return true;\n  }\n\n  const ageDays = daysBetween(node.created_at, new Date());\n  if (ageDays < config.never_compress.age_days_less_than) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Checks if a node meets compression requirements.\n */\nexport function meetsCompressionRequirements(\n  node: { lifecycle: string; dormant_since?: string; importance_score: number },\n  strongActiveEdges: number,\n  config: CompressionConfig\n): boolean {\n  if (node.lifecycle !== 'dormant') {\n    return false;\n  }\n  if (!node.dormant_since) {\n    return false;\n  }\n\n  const dormantDays = daysBetween(node.dormant_since, new Date());\n  if (dormantDays < config.candidate_requirements.dormant_days_minimum) {\n    return false;\n  }\n  if (node.importance_score > config.candidate_requirements.importance_max) {\n    return false;\n  }\n  if (strongActiveEdges > config.candidate_requirements.strong_active_edges_max) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Creates compression state for a node.\n */\nexport function createCompressionState(\n  summaryId: string,\n  restorableDays: number\n): NodeCompressionState {\n  const now = new Date();\n  const restorableUntil = new Date(now);\n  restorableUntil.setDate(restorableUntil.getDate() + restorableDays);\n\n  return {\n    compressed_into: summaryId,\n    compressed_at: now.toISOString(),\n    restorable_until: restorableUntil.toISOString(),\n  };\n}\n\n/**\n * Checks if a compressed node is still restorable.\n */\nexport function isRestorable(state: NodeCompressionState): boolean {\n  if (!state.restorable_until) {\n    return false;\n  }\n  const expiry = new Date(state.restorable_until);\n  const now = new Date();\n  return now < expiry;\n}\n\n/**\n * Creates an edge record for preservation.\n */\nexport function createEdgeRecord(\n  sourceNodeId: string,\n  targetNodeId: string,\n  edgeType: string,\n  weight: number\n): CompressedEdgeRecord {\n  return {\n    original_source: sourceNodeId,\n    target: targetNodeId,\n    original_type: edgeType,\n    original_weight: weight,\n  };\n}\n\n/**\n * Calculates aggregated weight for summary edges.\n */\nexport function calculateAggregatedWeight(records: CompressedEdgeRecord[]): number | null {\n  if (records.length === 0) {\n    return null;\n  }\n  const maxWeight = Math.max(...records.map((r) => r.original_weight));\n  return maxWeight >= 0.5 ? maxWeight : null;\n}\n\n/**\n * Generates a summary node ID.\n */\nexport function generateSummaryNodeId(): string {\n  return 'sum_' + nanoid(NANOID_LENGTH);\n}\n\n// ============================================================\n// WEIGHTED EDGE FACTORY\n// ============================================================\n\n/**\n * Creates a weighted edge from base properties.\n */\nexport function createWeightedEdge(options: {\n  source: string;\n  target: string;\n  type: ExtendedEdgeType;\n  status?: EdgeStatus;\n  creationSource: EdgeCreationSource;\n  baseWeight?: number;\n  confidence?: number;\n}): WeightedEdge {\n  const now = new Date().toISOString();\n  const baseWeight = options.baseWeight ?? EDGE_WEIGHTS[options.type] ?? 0.5;\n\n  return {\n    id: EDGE_ID_PREFIX + nanoid(NANOID_LENGTH),\n    source: options.source,\n    target: options.target,\n    type: options.type,\n    status: options.status ?? 'confirmed',\n    strength: baseWeight,\n    confidence: options.confidence ?? 1.0,\n    neural: {\n      co_activation_count: 0,\n      last_co_activation: now,\n      decay_factor: 1.0,\n    },\n    provenance: {\n      source_type: options.creationSource as SourceType,\n      created_at: now,\n    },\n    components: createWeightComponents({ base_weight: baseWeight }),\n    creation_source: options.creationSource,\n    consecutive_ignored: 0,\n    activation_count: 0,\n  };\n}\n\n// ============================================================\n// VALIDATION FUNCTIONS\n// ============================================================\n\nexport function validateWeightComponents(components: unknown): components is EdgeWeightComponents {\n  return EdgeWeightComponentsSchema.safeParse(components).success;\n}\n\nexport function validateProvisionalState(state: unknown): state is ProvisionalEdgeState {\n  return ProvisionalEdgeStateSchema.safeParse(state).success;\n}\n\nexport function validateSession(session: unknown): session is Session {\n  return SessionSchema.safeParse(session).success;\n}\n\nexport function validateSummaryNode(node: unknown): node is SummaryNode {\n  return SummaryNodeSchema.safeParse(node).success;\n}\n\nexport function validateCompressionState(state: unknown): state is NodeCompressionState {\n  return NodeCompressionStateSchema.safeParse(state).success;\n}\n\nexport function validateEmbeddingFreshness(state: unknown): state is EmbeddingFreshnessState {\n  return EmbeddingFreshnessStateSchema.safeParse(state).success;\n}\n","/**\n * @module @nous/core/edges\n * @description Edge schema for relationships between nodes\n * @version 0.1.0\n * @spec Brainstorms/Specs/storm-011/spec/edge-schema.ts\n *\n * Edges are first-class citizens in Nous. They enable:\n * - Graph traversal in SSA\n * - Relationship-aware retrieval\n * - Contradiction/supersession tracking\n */\n\nimport { z } from 'zod';\nimport { nanoid } from 'nanoid';\nimport {\n  NANOID_LENGTH,\n  EDGE_ID_PREFIX,\n  EDGE_TYPES,\n  SOURCE_TYPES,\n  type EdgeType,\n  type SourceType,\n} from '../constants';\n\n// ============================================================\n// ID GENERATION\n// ============================================================\n\n/**\n * Generates a globally unique edge ID.\n * Format: \"e_\" + 12-character nanoid\n */\nexport function generateEdgeId(): string {\n  return EDGE_ID_PREFIX + nanoid(NANOID_LENGTH);\n}\n\n// ============================================================\n// EDGE NEURAL PROPERTIES\n// ============================================================\n\n/**\n * Neural properties for edge decay and strengthening.\n * Supports Hebbian learning (\"neurons that fire together wire together\").\n */\nexport interface EdgeNeuralProperties {\n  /** How many times these nodes were activated together */\n  co_activation_count: number;\n  /** When nodes were last co-activated (ISO 8601) */\n  last_co_activation: string;\n  /** Current decay factor (0-1). Lower = more decayed */\n  decay_factor: number;\n}\n\nexport const EdgeNeuralPropertiesSchema = z.object({\n  co_activation_count: z.number().int().min(0),\n  last_co_activation: z.string().datetime(),\n  decay_factor: z.number().min(0).max(1),\n});\n\n// ============================================================\n// EDGE PROVENANCE\n// ============================================================\n\n/**\n * How this edge was created.\n */\nexport interface EdgeProvenance {\n  /** How the edge was created */\n  source_type: SourceType;\n  /** When the edge was created (ISO 8601) */\n  created_at: string;\n  /** Confidence in extraction (if applicable) */\n  extraction_confidence?: number;\n}\n\nexport const EdgeProvenanceSchema = z.object({\n  source_type: z.enum(SOURCE_TYPES),\n  created_at: z.string().datetime(),\n  extraction_confidence: z.number().min(0).max(1).optional(),\n});\n\n// ============================================================\n// EDGE INTERFACE\n// ============================================================\n\n/**\n * A relationship between two nodes.\n *\n * Edges enable:\n * - SSA graph traversal (storm-005)\n * - Contradiction detection (storm-009)\n * - Cluster organization (storm-006)\n * - Weight-based retrieval ranking (storm-031)\n */\nexport interface NousEdge {\n  /** Globally unique edge ID */\n  id: string;\n  /** Source node ID (where edge originates) */\n  source: string;\n  /** Target node ID (where edge points) */\n  target: string;\n  /** Relationship type */\n  type: EdgeType;\n  /** More specific subtype (e.g., \"sibling\", \"parent\") */\n  subtype?: string;\n  /** Connection strength (0-1). Higher = stronger relationship */\n  strength: number;\n  /** Confidence in this edge (0-1). Higher = more certain */\n  confidence: number;\n  /** Neural properties for decay/strengthening */\n  neural: EdgeNeuralProperties;\n  /** Where this edge came from */\n  provenance: EdgeProvenance;\n}\n\nexport const NousEdgeSchema = z.object({\n  id: z.string().regex(/^e_[a-zA-Z0-9_-]{12}$/),\n  source: z.string(),\n  target: z.string(),\n  type: z.enum(EDGE_TYPES),\n  subtype: z.string().optional(),\n  strength: z.number().min(0).max(1),\n  confidence: z.number().min(0).max(1),\n  neural: EdgeNeuralPropertiesSchema,\n  provenance: EdgeProvenanceSchema,\n});\n\n// ============================================================\n// EDGE CREATION RULES\n// ============================================================\n\n/**\n * Edge creation rule definitions.\n * These rules determine how edges are automatically created during extraction.\n */\nexport const EDGE_CREATION_RULES = {\n  /** Rule 1: Co-mention - Entities mentioned in the same sentence */\n  CO_MENTION: {\n    type: 'relates_to' as EdgeType,\n    defaultStrength: 0.5,\n    description: 'Entities in same sentence',\n  },\n\n  /** Rule 2: Explicit relation - \"X causes Y\" */\n  EXPLICIT_CAUSAL: {\n    type: 'causes' as EdgeType,\n    defaultStrength: 0.8,\n    description: 'Explicit causal statement',\n  },\n\n  /** Rule 3: Containment - \"X is part of Y\" */\n  EXPLICIT_CONTAINMENT: {\n    type: 'part_of' as EdgeType,\n    defaultStrength: 0.9,\n    description: 'Explicit containment',\n  },\n\n  /** Rule 4: Temporal sequence - Events in order */\n  TEMPORAL_SEQUENCE: {\n    type: 'precedes' as EdgeType,\n    defaultStrength: 0.7,\n    description: 'Events in temporal order',\n  },\n\n  /** Rule 5: Extraction origin - Concept extracted from Episode */\n  EXTRACTION_ORIGIN: {\n    type: 'mentioned_in' as EdgeType,\n    defaultStrength: 1.0,\n    description: 'Concept from episode',\n  },\n\n  /** Rule 6: Embedding similarity - cosine > 0.85 */\n  EMBEDDING_SIMILARITY: {\n    type: 'similar_to' as EdgeType,\n    threshold: 0.85,\n    description: 'High semantic similarity',\n  },\n} as const;\n\n// ============================================================\n// FACTORY FUNCTIONS\n// ============================================================\n\nexport interface CreateEdgeOptions {\n  subtype?: string;\n  strength?: number;\n  confidence?: number;\n  sourceType?: SourceType;\n  extractionConfidence?: number;\n}\n\n/**\n * Creates a new edge with default values.\n */\nexport function createEdge(\n  source: string,\n  target: string,\n  type: EdgeType,\n  options: CreateEdgeOptions = {}\n): NousEdge {\n  const now = new Date().toISOString();\n\n  return {\n    id: generateEdgeId(),\n    source,\n    target,\n    type,\n    subtype: options.subtype,\n    strength: options.strength ?? 0.5,\n    confidence: options.confidence ?? 1.0,\n    neural: {\n      co_activation_count: 0,\n      last_co_activation: now,\n      decay_factor: 1.0,\n    },\n    provenance: {\n      source_type: options.sourceType ?? 'manual',\n      created_at: now,\n      extraction_confidence: options.extractionConfidence,\n    },\n  };\n}\n\n/**\n * Creates default neural properties for a new edge.\n */\nexport function createDefaultEdgeNeuralProperties(): EdgeNeuralProperties {\n  return {\n    co_activation_count: 0,\n    last_co_activation: new Date().toISOString(),\n    decay_factor: 1.0,\n  };\n}\n\n// ============================================================\n// EDGE MODIFICATION FUNCTIONS\n// ============================================================\n\n/**\n * Strengthens an edge based on co-activation (Hebbian learning).\n * \"Neurons that fire together wire together.\"\n */\nexport function strengthenEdge(edge: NousEdge, amount: number = 0.1): NousEdge {\n  const now = new Date().toISOString();\n\n  return {\n    ...edge,\n    strength: Math.min(1.0, edge.strength + amount),\n    neural: {\n      ...edge.neural,\n      co_activation_count: edge.neural.co_activation_count + 1,\n      last_co_activation: now,\n    },\n  };\n}\n\n/**\n * Applies decay to an edge.\n * Used by the forgetting model (storm-007).\n */\nexport function decayEdge(edge: NousEdge, decayRate: number = 0.05): NousEdge {\n  return {\n    ...edge,\n    neural: {\n      ...edge.neural,\n      decay_factor: Math.max(0, edge.neural.decay_factor - decayRate),\n    },\n  };\n}\n\n/**\n * Resets an edge's decay factor (reactivation).\n */\nexport function reactivateEdge(edge: NousEdge): NousEdge {\n  return {\n    ...edge,\n    neural: {\n      ...edge.neural,\n      decay_factor: 1.0,\n      last_co_activation: new Date().toISOString(),\n    },\n  };\n}\n\n/**\n * Updates an edge's confidence.\n */\nexport function updateEdgeConfidence(edge: NousEdge, confidence: number): NousEdge {\n  return {\n    ...edge,\n    confidence: Math.max(0, Math.min(1, confidence)),\n  };\n}\n\n// ============================================================\n// QUERY HELPERS\n// ============================================================\n\n/**\n * Checks if an edge connects two specific nodes (in either direction).\n */\nexport function edgeConnects(edge: NousEdge, nodeA: string, nodeB: string): boolean {\n  return (\n    (edge.source === nodeA && edge.target === nodeB) ||\n    (edge.source === nodeB && edge.target === nodeA)\n  );\n}\n\n/**\n * Gets the other node in an edge.\n */\nexport function getOtherNode(edge: NousEdge, nodeId: string): string | undefined {\n  if (edge.source === nodeId) return edge.target;\n  if (edge.target === nodeId) return edge.source;\n  return undefined;\n}\n\n/**\n * Checks if an edge is below the decay threshold.\n */\nexport function isEdgeDecayed(edge: NousEdge, threshold: number = 0.1): boolean {\n  return edge.neural.decay_factor < threshold;\n}\n\n/**\n * Checks if an edge should be pruned based on age and decay.\n */\nexport function shouldPruneEdge(\n  edge: NousEdge,\n  maxAgeDays: number = 90,\n  decayThreshold: number = 0.1\n): boolean {\n  const ageMs = Date.now() - new Date(edge.neural.last_co_activation).getTime();\n  const ageDays = ageMs / (1000 * 60 * 60 * 24);\n\n  return ageDays > maxAgeDays && edge.neural.decay_factor < decayThreshold;\n}\n\n/**\n * Filters edges by type.\n */\nexport function filterEdgesByType(edges: NousEdge[], type: EdgeType): NousEdge[] {\n  return edges.filter((edge) => edge.type === type);\n}\n\n/**\n * Gets all edges connected to a node.\n */\nexport function getEdgesForNode(edges: NousEdge[], nodeId: string): NousEdge[] {\n  return edges.filter((edge) => edge.source === nodeId || edge.target === nodeId);\n}\n\n/**\n * Gets outgoing edges from a node.\n */\nexport function getOutgoingEdges(edges: NousEdge[], nodeId: string): NousEdge[] {\n  return edges.filter((edge) => edge.source === nodeId);\n}\n\n/**\n * Gets incoming edges to a node.\n */\nexport function getIncomingEdges(edges: NousEdge[], nodeId: string): NousEdge[] {\n  return edges.filter((edge) => edge.target === nodeId);\n}\n\n/**\n * Sorts edges by strength (descending).\n */\nexport function sortEdgesByStrength(edges: NousEdge[]): NousEdge[] {\n  return [...edges].sort((a, b) => b.strength - a.strength);\n}\n\n/**\n * Sorts edges by co-activation count (descending).\n */\nexport function sortEdgesByCoActivation(edges: NousEdge[]): NousEdge[] {\n  return [...edges].sort(\n    (a, b) => b.neural.co_activation_count - a.neural.co_activation_count\n  );\n}\n\n// ============================================================\n// EDGE VALIDATION\n// ============================================================\n\n/**\n * Validates an edge against the schema.\n */\nexport function validateEdge(edge: unknown): edge is NousEdge {\n  return NousEdgeSchema.safeParse(edge).success;\n}\n\n/**\n * Parses and validates edge data.\n */\nexport function parseEdge(data: unknown): NousEdge {\n  return NousEdgeSchema.parse(data);\n}\n\n/**\n * Safely parses edge data, returning null on failure.\n */\nexport function safeParseEdge(data: unknown): NousEdge | null {\n  const result = NousEdgeSchema.safeParse(data);\n  return result.success ? result.data : null;\n}\n\n// ============================================================\n// RE-EXPORTS\n// ============================================================\n\nexport type { EdgeType, SourceType };\n\n// Export weight module (storm-031)\nexport * from './weight/index';\n"]}